<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Image Generator</title>
  <style>
    body {
      background-color: #1A1817;
      color: #C85DE9;
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }

    .controls {
      max-width: 500px;
      margin: 0 auto 20px;
      text-align: left;
    }

    label {
      display: block;
      margin-top: 10px;
    }

    input, select, textarea, button {
      background: #2A2726;
      color: #C85DE9;
      border: 1px solid #C85DE9;
      padding: 6px;
      margin-top: 5px;
      width: 100%;
      box-sizing: border-box;
    }

    input[type="color"], input[type="range"] {
      padding: 0;
      height: 32px;
    }

    button {
      margin-top: 20px;
      cursor: pointer;
    }

    canvas {
      display: block;
      margin: 20px auto;
      border: 1px solid #C85DE9;
    }
  </style>
</head>
<body>

<h1>Image Generator</h1>

<div class="controls">
  <label>Upload Image:
    <input type="file" id="imageUpload">
  </label>

  <label>Text for Bar:
    <input type="text" id="customText" placeholder="Your caption here">
  </label>

  <label>Font:
    <select id="fontFamily">
      <option value="Arial">Arial</option>
      <option value="Georgia">Georgia</option>
      <option value="Courier New">Courier New</option>
      <option value="Verdana">Verdana</option>
      <option value="Times New Roman">Times New Roman</option>
    </select>
  </label>

  <label>Text Size:
    <input type="number" id="textSize" value="32">
  </label>

  <label>Text Color:
    <input type="color" id="textColor" value="#ffffff">
  </label>

  <label>Bar Color:
    <input type="color" id="bgColor" value="#000000">
  </label>

  <label><input type="checkbox" id="italic"> Italic</label>
  <label><input type="checkbox" id="dropShadow"> Drop Shadow</label>
  <label><input type="checkbox" id="glow"> Glow</label>
</div>

<button onclick="generateImage()">Generate Image</button>
<canvas id="canvas" width="800" height="600"></canvas>

<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  let baseImage = null;

  document.getElementById("imageUpload").addEventListener("change", function (e) {
    const reader = new FileReader();
    reader.onload = function (event) {
      baseImage = new Image();
      baseImage.onload = () => drawBase();
      baseImage.src = event.target.result;
    };
    reader.readAsDataURL(e.target.files[0]);
  });

  function drawBase() {
    if (!baseImage) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(baseImage, 0, 50, canvas.width, canvas.height - 50); // shift down for bar
  }

  function generateImage() {
    if (!baseImage) return alert("Please upload an image first!");

    const text = document.getElementById("customText").value;
    const font = document.getElementById("fontFamily").value;
    const size = parseInt(document.getElementById("textSize").value);
    const color = document.getElementById("textColor").value;
    const barColor = document.getElementById("bgColor").value;
    const italic = document.getElementById("italic").checked;
    const shadow = document.getElementById("dropShadow").checked;
    const glow = document.getElementById("glow").checked;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw bar background
    ctx.fillStyle = barColor;
    ctx.fillRect(0, 0, canvas.width, 50);

    // Draw base image shifted down
    ctx.drawImage(baseImage, 0, 50, canvas.width, canvas.height - 50);

    // Text styling
    let fontStyle = italic ? "italic " : "";
    fontStyle += `${size}px ${font}`;
    ctx.font = fontStyle;
    ctx.fillStyle = color;
    ctx.textBaseline = "middle";
    ctx.textAlign = "center";

    if (shadow || glow) {
      ctx.shadowColor = glow ? color : "#000";
      ctx.shadowBlur = glow ? 10 : 4;
      ctx.shadowOffsetX = shadow ? 2 : 0;
      ctx.shadowOffsetY = shadow ? 2 : 0;
    } else {
      ctx.shadowColor = "transparent";
    }

    // Draw centered text in the bar
    ctx.fillText(text, canvas.width / 2, 25);

    // Reset shadow for future actions
    ctx.shadowColor = "transparent";
  }
</script>

</body>
</html>
